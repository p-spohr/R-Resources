M * u * dunif(y) < f_X(y)
M * u * dunif(y) < f_X(y)
M * u * dunif(y) < f_X(y)
M * u * dunif(y) < f_X(y)
M * u * dunif(y) < f_X(y)
M * u * dunif(y) < f_X(y)
y <- runif(1, 0, 5)
runif(1, 0, 5)
runif(1)
dunif(runif(3))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,5))
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
dunif(runif(1,0,6), 0, 6)
for (t in n) {
y <- runif(1, 0, 6)
u <- runif(1)
while (M * u * dunif(y, 0, 6) >= f_X(y)) {
y <- runif(1, 0, 6)
u <- runif(1)
}
S[t] <- y
}
plot(S)
hist(S, freq = FALSE)
plot(f_X(seq(0,6,0.1)))
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(f_X(seq(0,6,0.1)))
plot(S)
(1 / length(S))
plot(seq(0, 1, (1 / length(S))), S)
A <- seq(0, 1, (1 / length(S)))
A <- seq((1 / length(S)), 1, (1 / length(S)))
plot(A, S)
plot(S, A)
hist(S, freq = FALSE)
plot(f_X(seq(0,6,0.1)))
hist(S, freq = FALSE)
plot(f_X(seq(0,6,0.1)))
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(f_X(seq(0,6,0.1)))
plot(f_X(seq(0,6,1)))
plot(f_X(seq(0,6,0.1)), type = 'l')
plot(f_X(seq(0,6,0.01)))
plot(f_X(seq(0,6,0.2)))
plot(f_X(seq(0,6,0.1)))
plot(f_X(seq(-1,7,0.1)))
plot(f_X(seq(-1,7,0.1)), type='l')
?plot
plot(1:6, f_X(seq(-1,7,0.1)), type='l')
plot(f_X(seq(-1,7,0.1)), type='l', xlim = c(-1,7))
plot(seq(-1,7,0.1),
f_X(seq(-1,7,0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(-1,7,0.1),
f_X(seq(-1,7,0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(-1,7,0.1),
f_X(seq(0,6,0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(-1,7,0.1),
f_X(seq(0,6.1,0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(0,6,0.1),
f_X(seq(0,6, 0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(0,5.9,0.1),
f_X(seq(0,5.9, 0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(0,6.1,0.1),
f_X(seq(0,6.1, 0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE)
plot(seq(0,6,0.1),
f_X(seq(0,6, 0.1)),
type='l')
par(mfrow = c(1,2))
hist(S, freq = FALSE, ylim = c(0, 0.3))
plot(seq(0,6,0.1),
f_X(seq(0,6, 0.1)),
type='l')
H <- vector('numeric')
for (t in n) {
u <- runif(1)
while (u >= f_X(y)) {
u <- runif(1)
}
H[t] <- u
}
plot(H)
hist(H)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= rnorm(1, 3, 3)
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
runif(1) >= f_X(rnorm(1, 3, 3))
H <- vector('numeric')
for (t in n) {
u <- runif(1)
y <- rnorm(1, 3, 3)
while (u >= f_X(y)) {
u <- runif(1)
}
H[t] <- u
}
for (t in n) {
u <- runif(1)
y <- rnorm(1, 3, 3)
while (u >= f_X(y)) {
u <- runif(1)
}
H[t] <- u
}
H <- vector('numeric')
for (t in n) {
u <- runif(1)
y <- runif(1, 0, 6)
while (u >= f_X(y)) {
u <- runif(1)
}
H[t] <- u
}
plot(H)
hist(H)
hist(H, freq = FALSE)
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
runif(1) >= f_X(runif(1, 0, 6))
plot(H)
hist(H, freq = FALSE)
TTT <- runif(10000, 0, 6)
plot(TTT)
K <- runif(10000, 0, 6)
plot(K)
?dunif
P <- dunif(10000, 0, 6)
hist(P)
plot(P)
P <- dunif(1:10000, 0, 6)
hist(P)
plot(P)
P <- dunif(K, 0, 6)
K <- runif(10000, 0, 6)
plot(K)
P <- dunif(K, 0, 6)
plot(P)
P <- dunif(K, 0, 1)
K <- runif(10000, 0, 6)
plot(K)
par(mfrow=c(1,1))
K <- runif(10000, 0, 6)
plot(K)
P <- dunif(K, 0, 6)
K <- runif(10000, 0, 1)
plot(K)
AX <- seq(0, 6, 0.1)
AX <- seq(0, 6, 0.01)
par(mfrow=c(1,1))
K <- runif(10000, 0, 1)
plot(K)
AX <- seq(0, 6, (6/n))
n <- 10000
K <- runif(n, 0, 1)
plot(K)
AX <- seq(0, 6, (6/n))
K <- runif(n+1, 0, 1)
n <- 10000
K <- runif(n+1, 0, 1)
plot(K)
AX <- seq(0, 6, (6/n))
plot(AX, f_x(AX), type='l')
X <- c(0,2,3,5,6)
P <- c(0, 0.1, 0.3, 0.2, 0.1, 0)
f_X <- stepfun(X,P, right = FALSE)
plot(f_X)
n <- 10000
K <- runif(n+1, 0, 1)
plot(K)
AX <- seq(0, 6, (6/n))
plot(AX, f_x(AX), type='l')
plot(AX, f_X(AX), type='l')
plot(AX, f_X(AX), type='l', ylim=c(0,1))
plot(AX, f_X(AX), type='l', ylim=c(0,0.3))
L <- vector('numeric')
L <- matrix('numeric')
L <- f_X(AX)
K <= L
sum(K <= L)
K[K <= L]
length(K[K <= L])
plot(c(1,NA,2,NA,NA,4,5,10))
L[L > K] <- NA
L
plot(L)
length(L)
L <- f_X(AX)
L[K > L] <- NA
plot(L)
L <- f_X(AX)
K[K > L] <- NA
plot(K)
plot(AX, K)
plot(F_X(K))
hist(K)
# vectorize function using for loop
F_X <- function(X) {
i <- 1
Z <- vector('numeric')
for (x in X) {
if (x < 0) {
Z[i] <- 0
} else if (x >= 0 & x < 2) {
Z[i] <- 0.1 * x
} else if (x >= 2 & x < 3) {
Z[i] <- 0.3 * x - 0.4
} else if (x >= 3 & x < 5) {
Z[i] <- 0.2 * x - 0.1
} else if (x >=5 & x < 6) {
Z[i] <- 0.1 * x + 0.4
} else {
Z[i] <- 1
}
i <- i + 1
}
return(Z)
}
plot(F_X(K))
# vectorize function using for loop
F_X <- function(Z) {
i <- 1
Z <- vector('numeric')
for (x in X) {
if (x < 0) {
Z[i] <- 0
} else if (x >= 0 & x < 2) {
Z[i] <- 0.1 * x
} else if (x >= 2 & x < 3) {
Z[i] <- 0.3 * x - 0.4
} else if (x >= 3 & x < 5) {
Z[i] <- 0.2 * x - 0.1
} else if (x >=5 & x < 6) {
Z[i] <- 0.1 * x + 0.4
} else {
Z[i] <- 1
}
i <- i + 1
}
return(Z)
}
plot(F_X(K))
plot(AX, F_X(K))
F_X(K)
# vectorize function using for loop
F_X <- function(X) {
i <- 1
Z <- vector('numeric')
for (x in X) {
if (x < 0) {
Z[i] <- 0
} else if (x >= 0 & x < 2) {
Z[i] <- 0.1 * x
} else if (x >= 2 & x < 3) {
Z[i] <- 0.3 * x - 0.4
} else if (x >= 3 & x < 5) {
Z[i] <- 0.2 * x - 0.1
} else if (x >=5 & x < 6) {
Z[i] <- 0.1 * x + 0.4
} else {
Z[i] <- 1
}
i <- i + 1
}
return(Z)
}
F_X(K)
VaR_X <- function(X) {
i <- 1
Z <- vector('numeric')
for (x in X) {
if (x <= 0) {
Z[i] <- 0
} else if (x > 0 & x <= 0.2) {
Z[i] <- 10 * x
} else if (x > 0.2 & x <= 0.5) {
Z[i] <- (10/3) * x + (4/3)
} else if (x > 0.5 & x <= 0.9) {
Z[i] <- 5 * x + 0.5
} else if (x > 0.9 & x <= 1) {
Z[i] <- 10 * x - 4
} else {
Z[i] <- 1
}
i <- i + 1
}
return(Z)
}
VaR_X(K)
VaR_X <- function(X) {
i <- 1
Z <- vector('numeric')
for (x in X) {
if (x <= 0) {
Z[i] <- 0
} else if (x > 0 & x <= 0.2) {
Z[i] <- 10 * x
} else if (x > 0.2 & x <= 0.5) {
Z[i] <- (10/3) * x + (4/3)
} else if (x > 0.5 & x <= 0.9) {
Z[i] <- 5 * x + 0.5
} else if (x > 0.9 & x <= 1) {
Z[i] <- 10 * x - 4
} else {
Z[i] <- 1
}
i <- i + 1
}
return(Z)
}
VaR_X(K)
#### show the points on the density graph ####
n <- 10000
K <- runif(n+1, 0, 1)
plot(K)
plot(AX, f_X(AX), type='l', ylim=c(0,0.3))
AX <- seq(0, 6, (6/n))
L <- f_X(AX)
K[K > L] <- NA
plot(AX, K)
?hist
hist(K, breaks = c(0,2,3,5,6))
?hist
hist(c(NA,NA,NA,1,2,3,4))
hist(c(NA,NA,NA,1,2,3,4), breaks = c(0,1,3,6))
plot(AX, K)
hist(K, breaks = c(0,0.1,0.3,0.2,0.1,0))
hist(K, breaks = c(1,2))
hist(K, breaks = c(1,2,3,4,5,6))
hist(K, breaks = c(0,1,2,3,4,5,6))
hist(K, breaks = c(0,1,2,3,4,5,6,7))
hist(K, breaks = c(0.5))
hist(K, breaks = c(0.5,1))
hist(K, breaks = c(0.1,0.5,1))
hist(K, breaks = c(0,0.1,0.5,1))
hist(K, breaks = c(0,0.2,0.5,1))
hist(K, breaks = c(0.1,0.2,0.5,1))
hist(K, breaks = c(0.1,0.2,0.5,0.9,1))
hist(K, breaks = c(0,0.1,0.2,0.5,0.9,1))
hist(K, breaks = c(0,0.1,0.2,0.5,0.9))
hist(K, breaks = c(0,0.1,0.2,0.5))
hist(K, breaks = c(0,0.1,0.2,0.3))
plot(AX, K)
n = 1:10000
M = 1.5
Y <- rt(n, 2)
plot(Y)
par(mfrow = c(1,1))
n = 1:10000
M = 1.5
plot(f_X(seq(0,6,0.1)))
S <- vector('numeric')
for (t in n) {
y <- runif(1, 0, 6)
u <- runif(1)
while (M * u * dunif(y, 0, 6) >= f_X(y)) {
y <- runif(1, 0, 6)
u <- runif(1)
}
S[t] <- y
}
par(mfrow = c(1,2))
hist(S, freq = FALSE, ylim = c(0, 0.3))
plot(seq(0,6,0.1),
f_X(seq(0,6, 0.1)),
type='l')
