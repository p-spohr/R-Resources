?Box.test
wn <- rnorm(1000)
Box.test(wn, 1, type = 'Ljung-Box')
Box.test(wn, c(1,2), type = 'Ljung-Box')
test <- Box.test(wn, 1, type = 'Ljung-Box')
for (i in 0:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste("Lag ", i, ": ", test$p.value))
}
for (i in 0:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", test$p.value))
}
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", test$p.value))
}
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
acf(wn)
acf(wn, type = 'correlation')
test <- Box.test(wn, i, type = 'Ljung')
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
test <- Box.test(wn, 5, type = 'Ljung-Box')
test$p.value
test$statistic
test$parameter
test$data.name
test
wn <- rnorm(1000, 0, 5)
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn <- rnorm(10000, 0, 5)
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn <- rnorm(100000, 0, 1)
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn <- rnorm(1000000, 0, 1)
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn_acf <- acf(wn, type = 'correlation')
wn_acf <- acf(wn, type = 'correlation')
wn <- rnorm(1000, 0, 1)
wn_acf <- acf(wn, type = 'correlation')
wn_acf$
wn_acf$n.used
n <- 1000
wn <- rnorm(n, 0, 1)
wn_acf <- acf(wn, type = 'correlation')
rho <- wn_acf[1:tau] ; rho
tau <- 5
rho <- wn_acf[1:tau] ; rho
tau <- 5
rho <- wn_acf$acf[1:tau] ; rho
tau <- 1:5
rho <- wn_acf$acf[1:length(tau)] ; rho
?qchi
?qchisq
qchisq(0.95)
qchisq(0.95, length(tau))
rho_cumsum <- cumsum(rho)
n * (n+2) * (rho_cumsum ** 2) / (n - tau)
rho_cumsum <- cumsum(rho) ** 2
n * (n+2) * sum(rho_cumsum / (n - tau) )
rho_cumsum <- ( cumsum(rho) ** 2 ) / ( n - tau)
n * (n+2) * sum(rho_cumsum)
rho_cumsum <- ( cumsum(rho) ** 2 ) / ( n - tau) )
n <- 10
wn <- rnorm(n, 0, 1)
wn_acf <- acf(wn, type = 'correlation')
tau <- 1:5
rho <- wn_acf$acf[1:length(tau)] ; rho
rho_cumsum <- ( cumsum(rho) ** 2 ) / ( n - tau)
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum) > qchisq(0.95, length(tau))
?Box.test
n * (n + 2) * (rho[1] ** 2) / (n - 1)
tau <- 1
rho <- wn_acf$acf[1:length(tau)] ; rho
rho_cumsum <- ( cumsum(rho) ** 2 ) / ( n - tau)
tau <- 1:5
rho_cumsum <- ( rho ** 2 ) / ( n - tau )
n * (n+2) * sum(rho_cumsum) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
( rho[5] ** 2 ) / ( n - tau[5] )
tau <- 1:5
rho <- wn_acf$acf[1:length(tau)] ; rho
rho_test <- ( rho ** 2 ) / ( n - tau )
( rho[5] ** 2 ) / ( n - tau[5] )
n * (n+2) * sum(rho_cumsum) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
wn1 <- rnorm(length(t)) * t
wn1 <- rnorm(length(t))
t <- 1:50
wn1 <- rnorm(length(t)) * t
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
plot(wn1, type = 'l')
wn1 <- 5 + rnorm(length(t)) * t
plot(wn1, type = 'l')
t <- 1:50
wn1 <- cumsum(rnorm(length(t)))
plot(wn1, type = 'l')
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn1_acf <- acf(wn1, type = 'correlation')
tau1 <- 1:5
rho1 <- wn_acf$acf[1:length(tau1)] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n - tau1 )
n <- 50
t <- 1:n
wn1 <- cumsum(rnorm(length(t)))
plot(wn1, type = 'l')
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn1_acf <- acf(wn1, type = 'correlation')
tau1 <- 1:5
rho1 <- wn_acf$acf[1:length(tau1)] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
n1 <- 50
t <- 1:n
wn1 <- cumsum(rnorm(length(t)))
plot(wn1, type = 'l')
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn1_acf <- acf(wn1, type = 'correlation')
tau1 <- 1:5
rho1 <- wn_acf$acf[1:length(tau1)] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
n * (n+2) * sum(rho_cumsum) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
tau <- 2:5
tau <- 2:5
rho <- wn_acf$acf[2:length(tau)] ; rho
rho_test <- ( rho ** 2 ) / ( n - tau )
n * (n+2) * sum(rho_cumsum) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
tau <- 2:5
rho <- wn_acf$acf[2:length(tau)] ; rho
rho_test <- ( rho ** 2 ) / ( n - tau )
n * (n+2) * sum(rho_test) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
n * (n+2) * sum(rho_test)
qchisq(0.95, length(tau))
n <- 10
wn <- rnorm(n, 0, 1)
for (i in 1:10) {
test <- Box.test(wn, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn_acf <- acf(wn, type = 'correlation')
tau <- 2:5
rho <- wn_acf$acf[2:length(tau)] ; rho
rho_test <- ( rho ** 2 ) / ( n - tau )
tau <- 2:5
rho <- wn_acf$acf[2:5] ; rho
rho_test <- ( rho ** 2 ) / ( n - tau )
n * (n+2) * sum(rho_test) > qchisq(0.95, length(tau))
n * (n+2) * sum(rho_test)
qchisq(0.95, length(tau))
n1 <- 50
t <- 1:n
wn1 <- cumsum(rnorm(length(t)))
wn1 <- cumsum(rnorm(length(t)))
n1 <- 50
t <- 1:n1
wn1 <- cumsum(rnorm(length(t)))
plot(wn1, type = 'l')
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn1_acf <- acf(wn1, type = 'correlation')
tau1 <- 2:5
rho1 <- wn_acf$acf[2:5] ; rho1
tau1 <- 2:5
rho1 <- wn_acf$acf[2:5] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
n * (n+2) * sum(rho_test1) > qchisq(0.95, length(tau1))
n * (n+2) * sum(rho_cumsum)
qchisq(0.95, length(tau))
n * (n+2) * sum(rho_test1)
qchisq(0.95, length(tau1))
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
tau1 <- 2:5
rho1 <- wn_acf$acf[2:5] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
n * (n+2) * sum(rho_test1)
qchisq(0.95, length(tau1))
n1 <- 50
n1 <- 50
t <- 1:n1
wn1 <- cumsum(rnorm(length(t)))
plot(wn1, type = 'l')
# p-value very small => reject null hypothesis => random walk not independently distributed
for (i in 1:10) {
test <- Box.test(wn1, i, type = 'Ljung-Box')
print(paste0("Lag ", i, ": ", round(test$p.value, 4)))
}
wn1_acf <- acf(wn1, type = 'correlation')
tau1 <- 2:5
rho1 <- wn1_acf$acf[2:5] ; rho1
rho_test1 <- ( rho1 ** 2 ) / ( n1 - tau1 )
n * (n+2) * sum(rho_test1) > qchisq(0.95, length(tau1))
n1 * (n1+2) * sum(rho_test1) > qchisq(0.95, length(tau1))
n1 * (n1+2) * sum(rho_test1)
qchisq(0.95, length(tau1))
